#footer-wrap 
  if theme.footer.socialBar.enable
    - let centerImg = theme.footer.socialBar.centerImg ? theme.footer.socialBar.centerImg : theme.avatar.img
    - let leftInfo = theme.footer.socialBar.left
    - let rightInfo = theme.footer.socialBar.right
    #footer_deal
      each item, index in leftInfo
        a.deal_link(href=url_for(item.link) title=item.title)
          if (item.icon.startsWith("fa"))
            i(class=`${item.icon}`)
          else if (item.icon.startsWith("icon"))
            svg.icon(aria-hidden="true")
              use(xlink:href=`#`+ item.icon)
          else if (item.icon.startsWith("anzhiyu"))
            i.anzhiyufont(class=`${item.icon}`)
      img.footer_mini_logo(title="返回顶部", alt="返回顶部" onclick="anzhiyu.scrollToDest(0, 500)", src=centerImg, size="50px")
      each item, index in rightInfo
        a.deal_link(href=url_for(item.link) title=item.title)
          if (item.icon.startsWith("fa"))
            i(class=`${item.icon}`)
          else if (item.icon.startsWith("icon"))
            svg.icon(aria-hidden="true")
              use(xlink:href=`#`+ item.icon)
          else if (item.icon.startsWith("anzhiyu"))
            i.anzhiyufont(class=`${item.icon}`)

  if theme.footer.owner.enable && !theme.footer.footerBar.enable
    - var nowYear = new Date().getFullYear()
    if theme.footer.owner.since && theme.footer.owner.since != nowYear
      .copyright!= `&copy;${theme.footer.owner.since} - ${nowYear} By ${config.author}`
    else
      .copyright!= `&copy;${nowYear} By ${config.author}`

  - let work_img = theme.footer.runtime.work_img
  - let work_description = theme.footer.runtime.work_description
  if theme.footer.runtime.enable
    #workboard
      if work_img != null
        img(src=`${work_img}`, alt=`${work_description}`, title=`${work_description}`, class="workSituationImg boardsign")
      #runtimeTextTip
  if theme.footer.custom_text
    .footer_custom_text!=`${theme.footer.custom_text}`

  if theme.footer.list.enable
    - let projectList = theme.footer.list.project
    #anzhiyu-footer
      each item, index in projectList
        .footer-group
          .footer-title=item.title
          .footer-links
            each iten, indey in item.links
              a.footer-item(title=iten.title href=url_for(iten.link))=iten.title
      if theme.footer.list.randomFriends > 0
        .footer-group
          .footer-title-group
            .footer-title 友链
            a.random-friends-btn#footer-random-friends-btn(href="javascript:addFriendLinksInFooter();" title="换一批友情链接")
              i.anzhiyufont.anzhiyu-icon-arrow-rotate-right
          .footer-links#friend-links-in-footer

  if theme.footer.bdageitem.enable
    p#ghbdages
      each item in theme.footer.bdageitem.list
        a.github-badge(target='_blank' href=item.link style='margin-inline:5px' data-title=item.message title=item.message)
          img(src=item.shields alt=item.message)

if theme.footer.footerBar && theme.footer.footerBar.enable
  #footer-bar
    .footer-bar-links
      .footer-bar-left
        #footer-bar-tips
          if theme.footer.owner.enable
            - var nowYear = new Date().getFullYear()
            - let authorLink = theme.footer.footerBar.authorLink ? theme.footer.footerBar.authorLink : config.url
            if theme.footer.owner.since && theme.footer.owner.since != nowYear
              .copyright!= `&copy;${theme.footer.owner.since} - ${nowYear} By `
                a.footer-bar-link(href=url_for(authorLink) target="_blank")
                  img.author-avatar(src="/img/博客静态头像.jpg" alt="avatar")
                  = config.author
            else
              .copyright!= `&copy;${nowYear} By `
                a.footer-bar-link(href=url_for(authorLink) target="_blank")
                  img.author-avatar(src="/img/博客静态头像.jpg" alt="avatar")
                  = config.author
          if theme.footer.footerBar.showBeian
            .beian-group
              a.footer-bar-link(
                href="https://www.beian.gov.cn/portal/registerSystemInfo?recordcode=11011402054421"
                target="_blank"
                rel="noopener external nofollow noreferrer"
                title="京公网安备xxxxxxx号"
                anzhiyutip="前往全国互联网安全管理服务平台"
              )
                img.beian-icon(
                  src="https://p.zhheo.com/VPiMHH24891181731917988329.png!cover"
                  alt="京公网安备xxxxxxxx号"
                )
                span 京公网安备xxxxxxxx号
              a.footer-bar-link(
                href="https://beian.miit.gov.cn/#/Integrated/index"
                target="_blank"
                rel="noopener external nofollow noreferrer"
                title="桂ICP备2025067806号-1"
                tips="前往工业和信息化部政务服务平台"
              ) 桂ICP备2025067806号-1

              a.footer-bar-link.allsite_ok(
                href="https://status.gbfun.cc/"
                target="_blank"
                rel="noopener external nofollow noreferrer"
                id="allsite_status"
                tips="查看我的项目状态"
              )
                .status-light
                span 状态检测中...

      #footer-type-tips
        if theme.footer.footerBar && theme.footer.footerBar.subTitle && theme.footer.footerBar.subTitle.enable
          .js-pjax
            include ./third-party/footerBarSubtitle.pug
      .footer-bar-right
        each item in theme.footer.footerBar.linkList
          a.footer-bar-link(href=url_for(item.link) title=item.text)=item.text
        if theme.footer.footerBar.cc.enable
          a.footer-bar-link.cc(href=url_for(theme.footer.footerBar.cc.link) title="cc协议")
            i.anzhiyufont.anzhiyu-icon-copyright-line
            i.anzhiyufont.anzhiyu-icon-creative-commons-by-line
            i.anzhiyufont.anzhiyu-icon-creative-commons-nc-line
            i.anzhiyufont.anzhiyu-icon-creative-commons-nd-line
        if theme.footer.footerBar.badge.enable
          a.footer-bar-link.badge(
            href=theme.footer.footerBar.badge.link
            title=theme.footer.footerBar.badge.title
            target="_blank"
            style="margin-left:8px"
          )
            img(
              src=`https://boringbay.com/api/badge/${theme.footer.footerBar.badge.domain}`
              height=theme.footer.footerBar.badge.height
              alt=theme.footer.footerBar.badge.title
            )

script.
  function updateStatusLight() {
    const statusEl = document.getElementById("allsite_status");
    if (!statusEl) return;

    const spanText = statusEl.querySelector("span");
    const statusDot = statusEl.querySelector(".status-light");

    fetch("/status.json?t=" + Date.now())
      .then(response => response.json())
      .then(data => {
        const monitors = data.monitors || [];
        const total = monitors.length;
        const downCount = monitors.filter(m => m.status !== 2).length;

        let statusLabel = "";
        let className = "";

        if (downCount === 0) {
          statusLabel = "所有业务正常";
          className = "allsite_ok";
        } else if (downCount < total) {
          statusLabel = "部分业务异常";
          className = "allsite_error";
        } else {
          statusLabel = "全部业务异常";
          className = "allsite_error";
        }

        // 更新显示文字
        if (spanText) spanText.innerText = statusLabel;

        // 更新 title 显示更新时间
        const now = new Date().toLocaleString("zh-CN");
        statusEl.setAttribute("title", "最新更新时间: " + now);

        // 替换 class
        statusEl.classList.remove("allsite_ok", "allsite_error");
        statusEl.classList.add(className);
      })
      .catch(error => {
        console.error("状态检测失败:", error);
        if (spanText) spanText.innerText = "状态检测失败";
        statusEl.setAttribute("title", "状态检测失败，请稍后重试");
        statusEl.classList.remove("allsite_ok");
        statusEl.classList.add("allsite_error");
      });
  }

  document.addEventListener("DOMContentLoaded", () => {
    updateStatusLight();
    setInterval(updateStatusLight, 1800000); // 每 30 分钟自动检测
  });
