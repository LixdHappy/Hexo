name: UptimeRobot çŠ¶æ€æ£€æµ‹

on:
  schedule:
    - cron: '*/30 * * * *'
  workflow_dispatch:

jobs:
  check-uptime:
    runs-on: ubuntu-latest

    steps:
      - name: æ£€å‡ºä»£ç 
        uses: actions/checkout@v3

      - name: å®‰è£… Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20'

      - name: è¿è¡Œ UptimeRobot çŠ¶æ€æ£€æµ‹è„šæœ¬
        run: |
          node update-status.js
        env:
          UPTIMEROBOT_API_KEY: ${{ secrets.UPTIMEROBOT_API_KEY }}

      - name: ä¿®æ”¹æ–‡ä»¶æ—¶é—´æˆ³ç¡®ä¿ git è¯†åˆ«åˆ°å˜åŒ–
        run: touch ./source/status.json

      - name: æäº¤æ›´æ–°çš„ status.json
        run: |
          git config --global user.name "${{ secrets.GITHUBUSERNAME }}"
          git config --global user.email "${{ secrets.GITHUBEMAIL }}"
          git add ./source/status.json
          git commit -m "ğŸ¤– æ›´æ–°ç›‘æ§çŠ¶æ€ $(TZ=Asia/Shanghai date +'%Y-%m-%d %H:%M:%S')" || echo "No changes to commit"
          git push --force
